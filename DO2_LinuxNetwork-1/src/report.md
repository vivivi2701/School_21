## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ipcalc. Part 1.
-   **1.1. –°–µ—Ç–∏ –∏ –º–∞—Å–∫–∏**
    1) –ê–¥—Ä–µ—Å —Å–µ—Ç–∏ 192.167.38.54/13:
        * **–ö–æ–º–∞–Ω–¥–∞:** `ipcalc 192.167.38.54/13`
        * **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
        * ![–°–∫—Ä–∏–Ω—à–æ—Ç —Å –≤—ã–≤–æ–¥–æ–º –∫–æ–º–∞–Ω–¥—ã ip calc 192.167.38.54/13 –Ω–∞ ws1](pics/ex1_1_ipcalc.png)
        * **–ò—Å–ø–æ–ª—å–∑—É—è ipcalc ‚Äî –∞–¥—Ä–µ—Å —Å–µ—Ç–∏:** `192.160.0.0`
    2)  –ü–µ—Ä–µ–≤–æ–¥ –º–∞—Å–æ–∫:
        * `255.255.255.0`: –ø—Ä–µ—Ñ–∏–∫—Å–Ω–∞—è `/24`, –¥–≤–æ–∏—á–Ω–∞—è `11111111.11111111.11111111.00000000`
        * `/15`: –æ–±—ã—á–Ω–∞—è `255.254.0.0`, –¥–≤–æ–∏—á–Ω–∞—è `11111111.11111110.00000000.00000000`
        * `11111111.11111111.11111111.11110000`: –æ–±—ã—á–Ω–∞—è `255.255.255.240`, –ø—Ä–µ—Ñ–∏–∫—Å–Ω–∞—è `/28`

    3)  –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç –≤ —Å–µ—Ç–∏ 12.167.38.4 –ø—Ä–∏ –º–∞—Å–∫–∞—Ö:
        | –ú–∞—Å–∫–∞ | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç |
        |-------|------------------|-------------------|
        | `/8` | `12.0.0.1` | `12.255.255.254` |
        | `255.255.0.0` (–¥–≤–æ–∏—á–Ω–∞—è: `11111111.11111111.00000000.00000000`) | `12.167.0.1` | `12.167.255.254` |
        | `255.255.254.0` | `12.167.38.1` | `12.167.39.254` |
        | `/4` | `0.0.0.1` | `15.255.255.254` |
        * ![–°–∫—Ä–∏–Ω —Å –∫–æ–º–∞–Ω–¥–∞–º–∏  ipcalc 12.167.38.4/–º–∞—Å–∫–∞](pics/ex1_1_host_min-max.png)

-   **1.2. localhost**
        * **localhost- –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è, –∫–æ—Ç–æ—Ä–æ–µ –≤—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ "—Å–∞–º–æ–≥–æ —Å–µ–±—è". –ï–≥–æ IP-–∞–¥—Ä–µ—Å ‚Äî 127.0.0.1.**
        * **–û–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –Ω–∞ localhost –≤–æ–∑–º–æ–∂–Ω–æ —Å IP:**
        * `194.34.23.100` ‚Äî **–Ω–µ—Ç, –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ 127.0.0.0/8.**
        * `127.0.0.2` ‚Äî **–¥–∞, –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ 127.0.0.0/8.**
        * `127.1.0.1` ‚Äî **–¥–∞, –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ 127.0.0.0/8.**
        * `128.0.0.1` ‚Äî **–Ω–µ—Ç, –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ 127.0.0.0/8.**

-   **1.3. –î–∏–∞–ø–∞–∑–æ–Ω—ã –∏ —Å–µ–≥–º–µ–Ω—Ç—ã —Å–µ—Ç–µ–π**
        1)  **–ü—É–±–ª–∏—á–Ω—ã–µ IP:** `134.43.0.2`, `192.172.0.1`, `172.68.0.2`, `192.169.168.1`
        2)  **–ß–∞—Å—Ç–Ω—ã–µ IP: –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π.** `10.0.0.45`, `192.168.4.2`, `172.20.250.4`, `172.0.2.1` (—á–∞—Å—Ç–∏—á–Ω–æ), `172.16.255.255`, `10.10.10.10`
        3)  **–í–æ–∑–º–æ–∂–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞ —à–ª—é–∑–∞ —É —Å–µ—Ç–∏ 10.10.0.0/18:** `10.10.0.2`, `10.10.10.10`, `10.10.1.255`.
        4)  **–ù–µ–≤–æ–∑–º–æ–∂–Ω—ã–µ:** `10.0.0.1`, `10.10.100.1`


## Part 2. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –¥–≤—É–º—è –º–∞—à–∏–Ω–∞–º–∏
#### –ü–æ–¥–Ω—è–ª–∞ –¥–≤–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã (–¥–∞–ª–µ–µ -- ws1 –∏ ws2).
#### –° –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã ip a –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –Ω–∞ ws1:
![–°–∫—Ä–∏–Ω —Å –≤—ã–æ–∑–æ–≤–æ–º ip a –Ω–∞ ws1](pics/ex02-00_ip_a_on_ws1.png)

#### –û–ø–∏—Å–∞–ª–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏, –Ω–∞ –æ–±–µ–∏—Ö –º–∞—à–∏–Ω–∞—Ö –∏ –∑–∞–¥–∞–ª–∞ —Å–ª–µ–¥—É—é—â–∏–µ –∞–¥—Ä–µ—Å–∞ –∏ –º–∞—Å–∫–∏: ws1 ‚Äî 192.168.100.10, –º–∞—Å–∫–∞ /16, ws2 ‚Äî 172.24.116.8, –º–∞—Å–∫–∞ /12:
    –°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏, —ç—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –≤–Ω—É—Ç—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –¥–æ–º–∞—à–Ω–µ–π —Å–µ—Ç–∏ –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –≤ —ç—Ç–æ–π —Å–µ—Ç–∏. –û–±—ã—á–Ω–æ —Ç–∞–∫–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏–º–µ—é—Ç –∞–¥—Ä–µ—Å–∞ –∏–∑ —á–∞—Å—Ç–Ω—ã—Ö IP-–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, 192.168.x.x, 172.16.x.x - 172.31.x.x –∏–ª–∏ 10.x.x.x.
    –í —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ç–∞–∫–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DHCP, –µ—Å–ª–∏ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏—Å–≤–∞–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∏–ª–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö IP-–∞–¥—Ä–µ—Å–æ–≤, –µ—Å–ª–∏ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏—Å–≤–∞–∏–≤–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é. –¢–∞–∫–∂–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –º–∞—Å–∫–∞ –ø–æ–¥—Å–µ—Ç–∏, —à–ª—é–∑ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ DNS-—Å–µ—Ä–≤–µ—Ä—ã.

    –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞, —á—Ç–æ–±—ã –∑–∞—â–∏—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —É–≥—Ä–æ–∑.
**–î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –∫–æ–º–∞–Ω–¥—É:**
    `sudo nano /etc/netplan/00-installer-config.yaml`

**–î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤—Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –∫–æ–º–∞–Ω–¥—É:**

`sudo netplan apply`
`–ï—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É–∫–∞–∑–∞–Ω–∞ –≤–µ—Ä–Ω–æ, –Ω–∞ –≤—ã—Ö–æ–¥–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫`

![–°–∫—Ä–∏–Ω —Å –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º etc/netplan/00-installer-config.yaml –∏ netplan apply –Ω–∞ ws1](pics/ex02_00_netplan_ws1.png)
![–°–∫—Ä–∏–Ω —Å –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–º —Ñ–∞–π–ª–æ–º etc/netplan/00-installer-config.yaml –∏ netplan apply –Ω–∞ ws2](pics/ex02_00_netplan_ws2.png)

**–í—ã–≤–æ–¥ –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã netplan apply –ø—É—Å—Ç–æ–π- –∑–Ω–∞—á–∏—Ç, –æ—à–∏–±–æ–∫ –Ω–µ—Ç**

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ –≤—Ä—É—á–Ω—É—é.
![–°–∫—Ä–∏–Ω —Å –∫–æ–º–∞–Ω–¥—ã ip add r –∏ –Ω–∞—á–∞–ª–∞ –ø–∏–Ω–≥–∞ —Å –æ–±–æ–∏—Ö –º–∞—à–∏–Ω –¥—Ä—É–≥ –¥—Ä—É–≥–∞](pics/ex02_01_ip_add_r_and_pinging.png)
#### –ü—Ä–æ–ø–∏–Ω–≥–æ–≤–∞–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∞—à–∏–Ω–∞–º–∏.
![–°–∫—Ä–∏–Ω —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø–∏–Ω–≥–∞ ws2 c ws1](pics/ex02_01_the_result_of_pinging_ws2_from_ws1.png)
![–°–∫—Ä–∏–Ω —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø–∏–Ω–≥–∞ ws1 c ws2](pics/ex02_01_the_result_of_pinging_ws1_from_ws2.png)
#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.
![–°–∫—Ä–∏–Ω —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç –º–∞—Ä—à—Ä—É—Ç–∞ –≤ netplan –¥–ª—è ws1](pics/ex02_02_netplan_for_ws1.png)
![–°–∫—Ä–∏–Ω —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç –º–∞—Ä—à—Ä—É—Ç–∞ –≤ netplan –¥–ª—è ws2](pics/ex02_02_netplan_for_w2.png)
#### –ü—Ä–æ–ø–∏–Ω–≥–æ–≤–∞–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∞—à–∏–Ω–∞–º–∏.
![–£—Å–ø–µ—à–Ω—ã–π –ø–∏–Ω–≥ —Å ws1 –ø–æ—Å–ª–µ –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç –º–∞—Ä—à—Ä—É—Ç–æ–≤](pics/ex02_02_successful_pinging_from_ws1.png)
![–£—Å–ø–µ—à–Ω—ã–π –ø–∏–Ω–≥ —Å ws2 –ø–æ—Å–ª–µ –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç –º–∞—Ä—à—Ä—É—Ç–æ–≤](pics/ex02_02_successful_pinging_from_ws2.png)

## Part 3. –£—Ç–∏–ª–∏—Ç–∞ iperf3
#### 3.1. –°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
-   **3.1. –°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è**
    1)  8 Mbps –≤ MB/s:
        * **–†–∞—Å—á—ë—Ç:** 8 –ú–±–∏—Ç/—Å √∑ 8 –±–∏—Ç/–±–∞–π—Ç = 1 –ú–ë/—Å
        * **–û—Ç–≤–µ—Ç:** 1 MB/s
    2)  100 MB/s –≤ Kbps:
        * **–†–∞—Å—á—ë—Ç:** 100 –ú–ë/—Å √ó 1024 –ö–ë/–ú–ë √ó 8 –±–∏—Ç/–±–∞–π—Ç = 819200 –ö–±–∏—Ç/—Å
        * **–û—Ç–≤–µ—Ç:** 819200 Kbps
    3)  1 Gbps –≤ Mbps:
        * **–†–∞—Å—á—ë—Ç:** 1 –ì–±–∏—Ç/—Å √ó 1000 –ú–±–∏—Ç/–ì–±–∏—Ç = 1000 –ú–±–∏—Ç/—Å
        * **–û—Ç–≤–µ—Ç:** 1000 Mbps
#### 3.2 –ò–∑–º–µ—Ä–∏–ª–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É ws1 –∏ ws2.
![–ó–∞–ø—É—Å—Ç–∏–ª–∞ iperf3 –≤ —Ä–µ–∂–∏–º–µ —Å–µ—Ä–≤–µ—Ä–∞ -s —Å ws1](pics/ex03_02_ws1_as_server_iperf.png)
![–ó–∞–ø—É—Å—Ç–∏–ª–∞ iperf3 –≤ —Ä–µ–∂–∏–º–µ –∫–ª–∏–µ–Ω—Ç–∞ -c c ws2, —É–∫–∞–∑–∞–≤ IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞](pics/ex03_02_ws2_as_client_iperf.png)

## Part 4. –°–µ—Ç–µ–≤–æ–π —ç–∫—Ä–∞–Ω.
#### 4.1. –£—Ç–∏–ª–∏—Ç–∞ iptables.
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–¥–∞–Ω–∏—é —Ç–∞–∫–∏–µ: –ù—É–∂–Ω–æ –±—ã–ª–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ñ–∞–π–ª –ø–æ–¥—Ä—è–¥ —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:**

    1) –ù–∞ ws1 –ø—Ä–∏–º–µ–Ω–∏–ª–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, –∫–æ–≥–¥–∞ –≤ –Ω–∞—á–∞–ª–µ –ø–∏—à–µ—Ç—Å—è –∑–∞–ø—Ä–µ—â–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ, –∞ –≤ –∫–æ–Ω—Ü–µ –ø–∏—à–µ—Ç—Å—è —Ä–∞–∑—Ä–µ—à–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ (—ç—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –ø—É–Ω–∫—Ç–æ–≤ 4 –∏ 5).
    2) –ù–∞ ws2 –ø—Ä–∏–º–µ–Ω–∏–ª–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, –∫–æ–≥–¥–∞ –≤ –Ω–∞—á–∞–ª–µ –ø–∏—à–µ—Ç—Å—è —Ä–∞–∑—Ä–µ—à–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ, –∞ –≤ –∫–æ–Ω—Ü–µ –ø–∏—à–µ—Ç—Å—è –∑–∞–ø—Ä–µ—â–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ (—ç—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –ø—É–Ω–∫—Ç–æ–≤ 4 –∏ 5).
    3) –û—Ç–∫—Ä—ã–ª–∞ –Ω–∞ –º–∞—à–∏–Ω–∞—Ö –¥–æ—Å—Ç—É–ø –¥–ª—è –ø–æ—Ä—Ç–∞ 22 (ssh) –∏ –ø–æ—Ä—Ç–∞ 80 (http).
    4) –ó–∞–ø—Ä–µ—Ç–∏–ª–∞ echo reply (–º–∞—à–∏–Ω–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ ¬´–ø–∏–Ω–≥–æ–≤–∞—Ç—å—Å—è¬ª, —Ç. –µ. –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ OUTPUT).
    5) –†–∞–∑—Ä–µ—à–∏–ª–∞ echo reply (–º–∞—à–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ ¬´–ø–∏–Ω–≥–æ–≤–∞—Ç—å—Å—è¬ª)(!).

![firewall.sh –¥–ª—è ws1- –°—Ç—Ä–∞—Ç–µ–≥–∏—è "–∑–∞–ø—Ä–µ—Ç –≤ –Ω–∞—á–∞–ª–µ, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ü–µ"](pics/ex04_01_firewall_for_ws1.png)
![firewall.sh –¥–ª—è ws2- –°—Ç—Ä–∞—Ç–µ–≥–∏—è "—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ, –∑–∞–ø—Ä–µ—Ç –≤ –∫–æ–Ω—Ü–µ"](pics/ex04_01_firewall_for_ws2.png)
#### 4.1 –ó–∞–ø—É—Å—Ç–∏–ª–∞ —Ñ–∞–π–ª—ã –Ω–∞ –æ–±–µ–∏—Ö –º–∞—à–∏–Ω–∞—Ö –∫–æ–º–∞–Ω–¥–∞–º–∏ chmod +x /etc/firewall.sh –∏ /etc/firewall.sh:
![–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–µ—Ä–≤–æ–ª–∞ –Ω–∞ –æ–±–µ–∏—Ö –º–∞—à–∏–Ω–∞—Ö](pics/ex04_01_applying_of_firewall.png)

**–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ —Ñ–∞–µ—Ä–≤–æ–ª–∞**
**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞ `ws1` (–∑–∞–ø—Ä–µ—Ç –≤ –Ω–∞—á–∞–ª–µ):**
        **–ù–∞ `ws1` –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –≥–¥–µ –∑–∞–ø—Ä–µ—â–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ (`DROP`) –±—ã–ª–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ –ø–µ—Ä–µ–¥ —Ä–∞–∑—Ä–µ—à–∞—é—â–∏–º (`ACCEPT`). –í —Ñ–∞–π–ª–µ `/etc/firewall.sh` —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥—è—â–∏–µ ICMP-–ø–∞–∫–µ—Ç—ã —Å —Ç–∏–ø–æ–º `echo-reply`. –ü–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–∞–≤–∏–ª–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑, `DROP` —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞–Ω—å—à–µ, —á–µ–º `ACCEPT`. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, `ws1` –Ω–µ –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –ø–∏–Ω–≥–∏.**
**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞ `ws2` (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ):**
        **–ù–∞ `ws2` –±—ã–ª–≤ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: —Ä–∞–∑—Ä–µ—à–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ (`ACCEPT`) —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–µ—â–∞—é—â–∏–º (`DROP`). `iptables` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É. –ï—Å–ª–∏ –ø–∞–∫–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª—É `ACCEPT`, –æ–Ω –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—Å—è, –Ω–µ –¥–æ–π–¥—è –¥–æ –ø—Ä–∞–≤–∏–ª–∞ `DROP`. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `ws2` –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –ø–∏–Ω–≥–∏, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Ä–∞–∑—Ä–µ—à–∞—é—â–µ–µ `echo-reply`, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–Ω—å—à–µ.**

#### 4.2 –£—Ç–∏–ª–∏—Ç–∞ nmap.
#### –ö–æ–º–∞–Ω–¥–æ–π ping –Ω–∞—à–ª–∞ –º–∞—à–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ ¬´–ø–∏–Ω–≥—É–µ—Ç—Å—è¬ª, –ø–æ—Å–ª–µ —á–µ–≥–æ —É—Ç–∏–ª–∏—Ç–æ–π nmap –ø–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ —Ö–æ—Å—Ç –º–∞—à–∏–Ω—ã –∑–∞–ø—É—â–µ–Ω.
![–£–¥–∞—á–Ω—ã–π –ø–∏–Ω–≥ —Å ws1 –∏ –Ω–µ—É–¥–∞—á–Ω—ã–π —Å ws2(–ø–æ—Å–ª–µ –∑–∞–ø—Ä–µ—Ç–∞ –≤ firewall), —É—Ç–∏–ª–∏—Ç–∞ nmap –∏ –µ–µ —É—Å–ø–µ—à–Ω—ã–π –≤—ã–≤–æ–¥ Host is up](pics/ex04_02_pinging_and_nmap.png)
#### (–ü—Ä–æ–≤–µ—Ä–∫–∞: –≤ –≤—ã–≤–æ–¥–µ nmap –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–∫–∞–∑–∞–Ω–æ: Host is up.)


------------------------------------------
## Part 5. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏!
#### –ü–æ–¥–Ω—è–ª–∞ –ø—è—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω (3 —Ä–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ (ws11, ws21, ws22) –∏ 2 —Ä–æ—É—Ç–µ—Ä–∞ (r1, r2)).
#### 5.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–¥—Ä–µ—Å–æ–≤ –º–∞—à–∏–Ω.
![–°–µ—Ç—å. –§–æ—Ç–æ –∏–∑ –∑–∞–¥–∞–Ω–∏—è.](pics/ex05-all_network.png)
#### –ù–∞—Å—Ç—Ä–æ–∏–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–∞—à–∏–Ω –≤ etc/netplan/00-installer-config.yaml —Å–æ–≥–ª–∞—Å–Ω–æ —Å–µ—Ç–∏ –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ.
![–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ etc/netplan/00-installer-config.yaml –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞ –∏...](pics/ex05_01-netplan_for_r1_r2.png)
![... —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ etc/netplan/00-installer-config.yaml –¥–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã ws11, ws21, ws22](pics/ex05_01-netplan_for_ws11_ws21_ws22.png)
#### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª–∞  —Å–µ—Ä–≤–∏—Å —Å–µ—Ç–∏. –û—à–∏–±–æ–∫ –Ω–µ—Ç, –∫–æ–º–∞–Ω–¥–æ–π ip -4 a –ø—Ä–æ–≤–µ—Ä–∏–ª–∞, —á—Ç–æ –∞–¥—Ä–µ—Å –º–∞—à–∏–Ω—ã –∑–∞–¥–∞–Ω –≤–µ—Ä–Ω–æ. –¢–∞–∫–∂–µ –ø—Ä–æ–ø–∏–Ω–≥–æ–≤–∞–ª–∞ ws22 —Å ws21:
![–ü–∏–Ω–≥ ws22 —Å ws21 –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã ip -4 a](pics/ex05_01-pinging_ws22_from_ws21.png)
#### –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ r1 —Å ws11:
![–ü–∏–Ω–≥ ws11 —Å r1](pics/ex05_01-pinging_r1_from_ws11.png)

#### 5.2. –í–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ IP-–∞–¥—Ä–µ—Å–æ–≤.
#### –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ IP –≤—ã–ø–æ–ª–Ω–∏–ª–∞ –∫–æ–º–∞–Ω–¥—É –Ω–∞ —Ä–æ—É—Ç–µ—Ä–∞—Ö:
`sysctl -w net.ipv4.ip_forward=1 (–ü—Ä–∏ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã.)`

![–í–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ IP –Ω–∞ —Ä–æ—É—Ç–µ—Ä–∞—Ö](pics/ex05_02-ip_forward=1_for_r1_r2.png)
#### –û—Ç–∫—Ä—ã–ª–∞ —Ñ–∞–π–ª /etc/sysctl.conf –∏ –¥–æ–±–∞–≤–∏–ª–∞ –≤ –Ω–µ–≥–æ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É:
`net.ipv4.ip_forward = 1(–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, IP-–ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ.)`

![–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–Ω—Ñ —Ñ–∞–π–ª –¥–ª—è r1, r2](pics/ex05_02-sysctl_conf_for_r1_r2.png)

#### 5.3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
#### –ù–∞—Å—Ç—Ä–æ–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—à–ª—é–∑) –¥–ª—è —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏–π. –î–ª—è —ç—Ç–æ–≥–æ –¥–æ–±–∞–≤–∏–ª–∞ default –ø–µ—Ä–µ–¥ IP-—Ä–æ—É—Ç–µ—Ä–∞ –≤ —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.
![–î–æ–±–∞–≤–ª–µ–Ω–∏–µ ip r1](pics/ex05_03-adding_ip_of_r1.png)

#### –í—ã–∑–≤–∞–ª–∞ ip r –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é, —á—Ç–æ –¥–æ–±–∞–≤–∏–ª—Å—è –º–∞—Ä—à—Ä—É—Ç –≤ —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.
![–î–æ–±–∞–≤–ª–µ–Ω–∏–µ ip r2 –Ω–∞ ws21 –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –µ–≥–æ, —Ç–∞–∫ –∂–µ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã ip r](pics/ex05_03-adding_ip_of_r2_on_ws21_and_applying.png)
![–ö–∞–∫ –∏—Ç–æ–≥ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ñ–æ—Ç–æ](pics/ex05_03-adding_ip_of_r2_on_ws22_and_applying.png)
#### –ü—Ä–æ–ø–∏–Ω–≥–æ–≤–∞–ª–∞ —Å ws11 —Ä–æ—É—Ç–µ—Ä r2 –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é –Ω–∞ r2, —á—Ç–æ –ø–∏–Ω–≥ –¥–æ—Ö–æ–¥–∏—Ç. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –∫–æ–º–∞–Ω–¥—É:
`tcpdump -tn -i eth0`

![–ü–∏–Ω–≥—É—é —Å ws11 —Ä–æ—É—Ç–µ—Ä r2](pics/ex05_03-pinging_r2_from_ws11.png)
![–¶—Å–ø–µ—à–Ω—ã–π –ø–∏–Ω–≥ —á–µ—Ä–µ–∑ tcpdump –Ω–∞ r2](pics/ex05_03-successful_pinging_via_tcpdump_on_r2.png)

#### 5.4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤.
#### –î–æ–±–∞–≤–∏–ª–∞ –≤ —Ä–æ—É—Ç–µ—Ä—ã r1 –∏ r2 —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤ —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.
![–ù–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞–∏—è –¥–¥–ª—è —Ä–æ—É—Ç–µ—Ä–æ–≤ —Å —É—Å–ø–µ—à–Ω—ã–º –ø–∏–Ω–≥–æ–º –Ω–∞ ws11](pics/ex05_04-new_netplan_for_r1_r2_with_successful_pinging_on_ws11.png)
#### –í—ã–∑–≤–∞–ª–∞ ip r –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é —Ç–∞–±–ª–∏—Ü—ã —Å –º–∞—Ä—à—Ä—É—Ç–∞–º–∏ –Ω–∞ –æ–±–æ–∏—Ö —Ä–æ—É—Ç–µ—Ä–∞—Ö.
![–ö–æ–º–∞–Ω–¥–∞ ip r –Ω–∞ –æ–±–æ–∏—Ö —Ä–æ—É—Ç–µ—Ä–∞—Ö.](pics/ex05_04-ip_r_on_r1_r2.png)
#### –ó–∞–ø—É—Å—Ç–∏–ª–ø –∫–æ–º–∞–Ω–¥—ã ip r list –Ω–∞ ws11:
![ip r list —Å –¥–≤—É–º—è –∞–π–ø–∏](pics/ex05_04-ip_r_list.png)

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –Ω–∞ `ws11`:**

    –ö–æ–≥–¥–∞ ws11 –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–∫–µ—Ç, –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø "–Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è" (Longest Prefix Match) –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–∞—Ä—à—Ä—É—Ç–∞.
    –î–ª—è –ø–∞–∫–µ—Ç–∞, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Ç—å `10.10.0.0/18`, —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –¥–≤–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞:

**–ú–∞—Ä—à—Ä—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`0.0.0.0/0`)** —Å –¥–ª–∏–Ω–æ–π –ø—Ä–µ—Ñ–∏–∫—Å–∞ `/0`.

**–ú–∞—Ä—à—Ä—É—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Ç—å (`10.10.0.0/18`)** —Å –¥–ª–∏–Ω–æ–π –ø—Ä–µ—Ñ–∏–∫—Å–∞ `/18`.

    –°–∏—Å—Ç–µ–º–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç —Å —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π –º–∞—Å–∫–æ–π (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `/18`), —Ç–∞–∫ –∫–∞–∫ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º. –ú–∞—Ä—à—Ä—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç—Ä–∞—Ñ–∏–∫–∞, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ –Ω–∞—à–ª–æ—Å—å –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞.

#### 5.5 –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤
#### –ó–∞–ø—É—Å—Ç–∏–ª–∞ –Ω–∞ r1 –∫–æ–º–∞–Ω–¥—É –¥–∞–º–ø–∞: tcpdump -tnv -i eth0. –ü—Ä–∏ –ø–æ–º–æ—â–∏ —É—Ç–∏–ª–∏—Ç—ã traceroute –ø–æ—Å—Ç—Ä–æ–∏–ª–∞ —Å–ø–∏—Å–æ–∫ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ –Ω–∞ –ø—É—Ç–∏ –æ—Ç ws11 –¥–æ ws21:
![–£—Å–ø–µ—à–Ω—ã–π traceroute –æ—Ç ws11 –¥–æ ws21](pics/ex05_05-traceroute_on_ws11.png)

**–í –≤—ã–≤–æ–¥–µ traceroute –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω —Å–ø–∏—Å–æ–∫ "–ø—Ä—ã–∂–∫–æ–≤" (hops) ‚Äî IP-–∞–¥—Ä–µ—Å–æ–≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—à—ë–ª –ø–∞–∫–µ—Ç.:**

`–ü–µ—Ä–≤—ã–π "–ø—Ä—ã–∂–æ–∫" ‚Äî —ç—Ç–æ r1 (10.10.0.1).`
`–í—Ç–æ—Ä–æ–π "–ø—Ä—ã–∂–æ–∫" ‚Äî —ç—Ç–æ r2 (10.100.0.12).`
`–¢—Ä–µ—Ç–∏–π "–ø—Ä—ã–∂–æ–∫" ‚Äî —ç—Ç–æ ws21 (10.20.0.10).`

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ —Ä–∞–±–æ—Ç—ã:**

`traceroute —Ä–∞–±–æ—Ç–∞–µ—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è—è UDP-–ø–∞–∫–µ—Ç—ã —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–º—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º TTL (Time to Live).`
`–ü–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç –∏–º–µ–µ—Ç TTL=1. –û–Ω –¥–æ—Å—Ç–∏–≥–∞–µ—Ç r1, r1 —É–º–µ–Ω—å—à–∞–µ—Ç TTL –¥–æ 0 –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ICMP-—Å–æ–æ–±—â–µ–Ω–∏–µ "Time to Live exceeded" –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ ws11. ws11 –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç IP-–∞–¥—Ä–µ—Å r1.`
`–í—Ç–æ—Ä–æ–π –ø–∞–∫–µ—Ç –∏–º–µ–µ—Ç TTL=2. –û–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç r1 (TTL=1), –¥–æ—Å—Ç–∏–≥–∞–µ—Ç r2, r2 —É–º–µ–Ω—å—à–∞–µ—Ç TTL –¥–æ 0 –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ICMP-—Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ. ws11 –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç IP-–∞–¥—Ä–µ—Å r2.`
`–ò —Ç–∞–∫ –¥–∞–ª–µ–µ, –ø–æ–∫–∞ –ø–∞–∫–µ—Ç –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç ws21.`

#### 5.6. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ ICMP –ø—Ä–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.
#### –ó–∞–ø—É—Å—Ç–∏–ª–∞ –Ω–∞ r1 –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞, –ø—Ä–æ—Ö–æ–¥—è—â–µ–≥–æ —á–µ—Ä–µ–∑ eth0 —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã: tcpdump -n -i eth0 icmp:
![–ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ tcpdump](pics/ex05_06-tcpdump.png)
#### –ü—Ä–æ–ø–∏–Ω–≥–æ–≤–∞–ª–∞ —Å ws11 –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π IP (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10.30.0.111) —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã: ping -c 1 10.30.0.111 :
![–ü–∏–Ω–≥ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∞–π–ø–∏ —Å ws11](pics/ex05_06-pinging_of_nonexistent_ip_from_ws11.png)

## Part 6. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IP —Å –ø–æ–º–æ—â—å—é DHCP.
#### –î–ª—è r2 –Ω–∞—Å—Ç—Ä–æ–∏–ª–∞ –≤ —Ñ–∞–π–ª–µ /etc/dhcp/dhcpd.conf –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–ª—É–∂–±—ã DHCP:
#### 1) –£–∫–∞–∑–∞–ª–∞ –∞–¥—Ä–µ—Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, DNS-—Å–µ—Ä–≤–µ—Ä –∏ –∞–¥—Ä–µ—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏:

![dhcp –Ω–∞ r2](pics/ex06-dhcp_r2.png)
#### 2) –í —Ñ–∞–π–ª–µ resolv.conf –ø—Ä–æ–ø–∏—Å–∞–ª–∞ nameserver 8.8.8.8:
![–Ω–æ–≤—ã–π nameserver –≥—É–≥–ª–∞ –≤ –∫–æ–Ω—Ñ–∏–≥–µ](pics/ex06-new_nameserver_of_google.png)
#### –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∞ —Å–ª—É–∂–±—É DHCP –∫–æ–º–∞–Ω–¥–æ–π systemctl restart isc-dhcp-server. –ú–∞—à–∏–Ω—É ws21 –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ reboot –∏ —á–µ—Ä–µ–∑ ip a –ø–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –æ–Ω–∞ –ø–æ–ª—É—á–∏–ª–∞ –∞–¥—Ä–µ—Å. –¢–∞–∫–∂–µ –ø—Ä–æ–ø–∏–Ω–≥–æ–≤–∞–ª–∞ ws22 —Å ws21:
![–ú–∞—à–∏–Ω–∞ ws21 –ø–æ–ª—É—á–∏–ª–∞ –∞–¥—Ä–µ—Å](pics/ex06-ip_a_on_ws21.png)
![–ü–∏–Ω–≥ ws21  —Å ws22](pics/ex06-pinging_ws22_from_ws21.png)
#### –£–∫–∞–∑–∞–ª–∞ MAC-–∞–¥—Ä–µ—Å —É ws11, –¥–ª—è —ç—Ç–æ–≥–æ –≤ etc/netplan/00-installer-config.yaml –Ω–∞–¥–æ –±—ã–ª–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏: macaddress: 10:10:10:10:10:BA, dhcp4: true :
![–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–π netplan –Ω–∞ ws11](pics/ex06-new_netplan_with_MAC_on_ws11.png)
#### –î–ª—è r1 –Ω–∞—Å—Ç—Ä–æ–∏–ª–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ r2, –Ω–æ —Å–¥–µ–ª–∞–ª–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–¥–∞–Ω–∏—é, –≤—ã–¥–∞—á—É –∞–¥—Ä–µ—Å–æ–≤ —Å –∂–µ—Å—Ç–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ MAC-–∞–¥—Ä–µ—Å—É (ws11). –ü—Ä–æ–≤–µ–ª–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —Ç–µ—Å—Ç—ã:
![–ñ–µ—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ ws11 –∫ –ú–ê–ö-–∞–¥—Ä–µ—Å—É](pics/ex06-dhcp_for_r1.png)

`option routers 10.10.0.1; ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —à–ª—é–∑–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —ç—Ç–æ–π —Å–µ—Ç–∏ –±—É–¥–µ—Ç 10.10.0.1.`
`option domain-name-servers 10.10.0.1; ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ DNS-—Å–µ—Ä–≤–µ—Ä–æ–º –±—É–¥–µ—Ç 10.10.0.1.`

#### –ó–∞–ø—Ä–æ—Å–∏–ª–∞ —Å ws21 –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞:
![–í—ã–≤–æ–¥ ip a –î–û –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ ws11](pics/ex06-ip_a_before_changing_it_on_ws11.png)
![–í—ã–≤–æ–¥ ip a –ü–û–°–õ–ï –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ ws11](pics/ex06-ip_a_after_changing_it_on_ws11.png)

**–í —Ä–∞–∑–¥–µ–ª–µ –ß–∞—Å—Ç—å 6, –≤–∫–ª—é—á–∏–ª–∞ —Å–ª–µ–¥—É—é—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞:**

    subnet: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–¥—Å–µ—Ç—å, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DHCP.
    netmask: –ó–∞–¥–∞—ë—Ç –º–∞—Å–∫—É –ø–æ–¥—Å–µ—Ç–∏.
    range: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω IP-–∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ DHCP-—Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏.
    option routers: –£–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞–º –∞–¥—Ä–µ—Å —à–ª—é–∑–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –≤—ã—Ö–æ–¥–∞ –≤ –¥—Ä—É–≥–∏–µ —Å–µ—Ç–∏.
    option domain-name-servers: –£–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞–º –∞–¥—Ä–µ—Å–∞ DNS-—Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω.
    host: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–ª–æ–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞.
    hardware ethernet: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç MAC-–∞–¥—Ä–µ—Å —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ä—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è –∂—ë—Å—Ç–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–∏.
    fixed-address: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP-–∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç—É —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º MAC-–∞–¥—Ä–µ—Å–æ–º.

## Part 7. NAT.
#### –í —Ñ–∞–π–ª–µ /etc/apache2/ports.conf –Ω–∞ ws22 –∏ r1 –∏–∑–º–µ–Ω–∏–ª–∞ —Å—Ç—Ä–æ–∫—É Listen 80 –Ω–∞ Listen 0.0.0.0:80, —Ç–æ –µ—Å—Ç—å —Å–¥–µ–ª–∞–ª–∞ —Å–µ—Ä–≤–µ—Ä Apache2 –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º.:
![–°–¥–ª–µ–ª–∞ —Å–µ—Ä–≤–µ—Ä –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º](pics/ex07-apache2.png)
#### –ó–∞–ø—É—Å—Ç–∏–ª–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä Apache –∫–æ–º–∞–Ω–¥–æ–π service apache2 start –Ω–∞ ws22 –∏ r1:
![–£—Å–ø–µ—à–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Apache](pics/ex07-successful_applying_of_apache2.png)
#### –î–æ–±–∞–≤–∏–ª–∞ –≤ —Ñ–∞–µ—Ä–≤–æ–ª, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å —Ñ–∞–µ—Ä–≤–æ–ª–æ–º –∏–∑ –ß–∞—Å—Ç–∏ 4, –Ω–∞ r2 —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:
    1) –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –≤ —Ç–∞–±–ª–∏—Ü–µ filter ‚Äî iptables -F;
    2) –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –≤ —Ç–∞–±–ª–∏—Ü–µ ¬´NAT¬ª ‚Äî iptables -F -t nat;
    3) –û—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã ‚Äî iptables --policy FORWARD DROP.
    –ó–∞–ø—É—Å—Ç–∏–ª–∞ —Ñ–∞–π–ª —Ç–∞–∫–∂–µ, –∫–∞–∫ –≤ –ß–∞—Å—Ç–∏ 4.
    –ü—Ä–æ–≤–µ—Ä–∏–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É ws22 –∏ r1 –∫–æ–º–∞–Ω–¥–æ–π ping.:

#### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ñ–∞–π–ª–∞ —Å —ç—Ç–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏, ws22 –Ω–µ –¥–æ–ª–∂–Ω–∞ ¬´–ø–∏–Ω–≥–æ–≤–∞—Ç—å—Å—è¬ª —Å r1.

![–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ—É–¥–∞—á–Ω—ã–π –ø–∏–Ω–≥ —Å —Ä1 –∏–∑-–∑–∞ —Ñ–∞–π–µ—Ä–≤–æ–ª–∞](pics/ex07-fail_of_pinging_from_r1_because_of_firewall.png)
#### –î–æ–±–∞–≤–∏–ª–∞ –≤ —Ñ–∞–π–ª –µ—â—ë –æ–¥–Ω–æ –ø—Ä–∞–≤–∏–ª–æ:
    4) –†–∞–∑—Ä–µ—à–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ ICMP.
    –ó–∞–ø—É—Å—Ç–∏–ª–∞ —Ñ–∞–π–ª —Ç–∞–∫–∂–µ, –∫–∞–∫ –≤ –ß–∞—Å—Ç–∏ 4.
#### –ü—Ä–æ–≤–µ—Ä–∏–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É ws22 –∏ r1 –∫–æ–º–∞–Ω–¥–æ–π ping.

`–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ñ–∞–π–ª–∞ —Å —ç—Ç–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏, ws22 –¥–æ–ª–∂–Ω–∞ ¬´–ø–∏–Ω–≥–æ–≤–∞—Ç—å—Å—è¬ª —Å r1.`

![–£—Å–ø–µ—à–Ω—ã–π –ø–∏–Ω–≥ —Å r1 ws22](pics/ex07-ping_ws22_r1.png)

#### –î–æ–±–∞–≤–∏–ª–∞ –≤ —Ñ–∞–π–ª –µ—â—ë –¥–≤–∞ –ø—Ä–∞–≤–∏–ª–∞:
    5) –í–∫–ª—é—á–∏–ª–∞ SNAT, –∞ –∏–º–µ–Ω–Ω–æ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö IP–∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏, –Ω–∞—Ö–æ–¥—è—â–µ–π—Å—è –∑–∞ r2 (–ø–æ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º –∏–∑ –ß–∞—Å—Ç–∏ 5 ‚Äî —Å–µ—Ç—å 10.20.0.0).
    –°–æ–≤–µ—Ç –∏–∑ –∑–∞–¥–∞–Ω–∏—è: —Å—Ç–æ–∏—Ç –ø–æ–¥—É–º–∞—Ç—å –æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –≤–Ω–µ—à–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º.
![–ù–æ–≤—ã–π –∞–ø–¥–µ–π—Ç —Ñ–∞–π–µ—Ä–≤–æ–ª–∞](pics/ex07-new_update_of_firewall.png)
####
    6) –í–∫–ª—é—á–∏–ª–∞ DNAT –Ω–∞ 8080 –ø–æ—Ä—Ç –º–∞—à–∏–Ω—ã r2 –∏ –¥–æ–±–∞–≤–∏–ª–∞ –∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—É Apache, –∑–∞–ø—É—â–µ–Ω–Ω–æ–º—É –Ω–∞ ws22, –¥–æ—Å—Ç—É–ø –∏–∑–≤–Ω–µ —Å–µ—Ç–∏.
    –°–æ–≤–µ—Ç –∏–∑ –∑–∞–¥–∞–Ω–∏—è: —Å—Ç–æ–∏—Ç —É—á–µ—Å—Ç—å, —á—Ç–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –Ω–æ–≤–æ–µ tcp-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–µ ws22 –∏ 80 –ø–æ—Ä—Ç—É.

![–ù–æ–≤—ã–π —Ñ–∞–π–µ—Ä–≤–æ–ª —Å –ø–æ—Ä—Ç–æ–º 8080](pics/ex07-firewall_with_port_8080.png)
#### –ò –Ω–∞–∫–æ–Ω–µ—Ü, —è –ø—Ä–æ–≤–µ—Ä–∏–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ TCP –¥–ª—è SNAT: –¥–ª—è —ç—Ç–æ–≥–æ —Å ws22 –ø–æ–¥–∫–ª—é—á–∏–ª–∞—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É Apache –Ω–∞ r1 –∫–æ–º–∞–Ω–¥–æ–π:
`telnet 10.10.0.1 (–ø–æ—Ä—Ç=)80`

![–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ TCP](pics/ex07-telnet_from_r1.png)
#### –ü—Ä–æ–≤–µ—Ä–∏–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ TCP –¥–ª—è DNAT: –¥–ª—è —ç—Ç–æ–≥–æ —Å r1 –ø–æ–¥–∫–ª—é—á–∏–ª–∞—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É Apache –Ω–∞ ws22 –∫–æ–º–∞–Ω–¥–æ–π telnet (–æ–±—Ä–∞—Ç–∏–ª–∞—Å—å –ø–æ –∞–¥—Ä–µ—Å—É r2 –∏ –ø–æ—Ä—Ç—É 8080):
![–û–±—Ä–∞—â–µ–Ω–∏–µ c –ø–µ—Ä–≤–æ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞ –ø–æ –∞–¥—Ä–µ—Å—É –≤—Ç–æ—Ä–æ–≥–æ—Ä–æ—É—Ç–µ—Ä–∞ –∏ –ø–æ—Ä—Ç—É 8080 —á—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É Apache](pics/ex07-telnet_from_r1_8080.png)


------------------------------------------
## Part 8. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ. –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å SSH Tunnels.
#### –ó–∞–ø—É—Å—Ç–∏–ª–∞ –Ω–∞ r2 —Ñ–∞–µ—Ä–≤–æ–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏–∑ –ß–∞—Å—Ç–∏ 7.
#### –ó–∞–ø—É—Å—Ç–∏–ª–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä Apache –Ω–∞ ws22 —Ç–æ–ª—å–∫–æ –Ω–∞ localhost (—Ç–æ –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–µ /etc/apache2/ports.conf –∏–∑–º–µ–Ω–∏–ª–∞ —Å—Ç—Ä–æ–∫—É Listen 80 –Ω–∞ Listen localhost:80).
![–ò–∑–º–µ–Ω–∏–ª–∞ —Å—Ç—Ä–æ–∫—É Listen 80 –Ω–∞ Listen localhost:80](pics/ex08-firewall_and_apache2.png)
#### –í–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å Local TCP forwarding —Å ws21 –¥–æ ws22, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—É –Ω–∞ ws22 —Å ws21 –∏
#### –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å Remote TCP forwarding c ws11 –¥–æ ws22, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—É –Ω–∞ ws22 —Å ws11:
![–£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—É —Å ws11 –Ω–∞ ws22](pics/ex08-ws22@10.20.0.20.png)
#### –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —Å—Ä–∞–±–æ—Ç–∞–ª–æ –ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –æ–±–æ–∏—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö, –ø–µ—Ä–µ—à–ª–∞ –≤–æ –≤—Ç–æ—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª (–∫–ª–∞–≤–∏—à–∞–º–∏ Alt + F2 –∏–ª–∏ + F4) –∏ –≤—ã–ø–æ–ª–Ω–∏–ª–∞  –∫–æ–º–∞–Ω–¥—É:
`telnet 127.0.0.1 (–ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç)8080`

**Local TCP forwarding (-L): –¢—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã (ws21) –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—É—é (ws22), –ø–æ–∑–≤–æ–ª—è—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç.**
**Remote TCP forwarding (-R): –¢—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å —É–¥–∞–ª—ë–Ω–Ω–æ–π –º–∞—à–∏–Ω—ã (r1) –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é (r2), –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—è –ø–æ—Ä—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—É—é, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥—Ä—É–≥–∏–º –º–∞—à–∏–Ω–∞–º –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É.**

![–£—Å–ø–µ—à–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è c ws21](pics/ex08-successful_connection.png)
![–£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å r1 –Ω–∞ r2](pics/ex08-successful_connection_to_r2_from_r1.png)

`–ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ! rymundzu, 11.08.2025 üíù`
